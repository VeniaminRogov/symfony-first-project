<!DOCTYPE html>
<html>
    <head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <link rel="stylesheet" href="../assets/styles/app.css">
        <title>{% block title %}{% endblock %}</title>
    </head>
    <body>
    
    {% block body %}
        {{ render(controller('App\\Controller\\HomeController::countClient')) }}
        <div class="container-fluid">
            {% include 'components/breadcrumbs.html.twig' %}
            <h1 class="text-center">
                {% block pageTitle %}{% endblock %}
            </h1>
                {% block content %}{% endblock %}
                {% include 'components/notice.html.twig' %}
        </div>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <script>
            const form = document.querySelector('form');
            const sort = document.querySelector('#search_form_sort');

            const pageInput = document.querySelector('#search_form_page');

            document.querySelectorAll('a.page-link').forEach(link => {
                link.addEventListener('click', e => {
                    e.preventDefault();
                    pageInput.value = e.target.getAttribute('href').split('').pop();
                    form.submit();
                });
            });

            sort.addEventListener('click', e => {
               pageInput.value = 1;
            });

            const addPhoneFormDeleteLink = item => {
                const removeFormButton = document.createElement('button');
                removeFormButton.innerHTML = 'Delete phone';

                item.appendChild(removeFormButton);

                removeFormButton.addEventListener('click', e => {
                    e.preventDefault();

                    item.remove();
                })
            }


            const addFormToCollection = (e) => {
                const collectionHolder = document.querySelector('.' + e.currentTarget.dataset.collectionHolderClass);
                const item = document.createElement('li');
                item.innerHTML = collectionHolder.dataset.prototype.replace(/__name__/g, collectionHolder.dataset.index);
                collectionHolder.appendChild(item);
                collectionHolder.dataset.index++;

                addPhoneFormDeleteLink(item);
            }

            document.querySelectorAll('.add_item_link').forEach(btn => {
                btn.addEventListener('click', addFormToCollection);
            });



            document.querySelectorAll('ul.phones li').forEach(phone => {
                addPhoneFormDeleteLink(phone)
            })
        </script>
    {% endblock %}
    </body>
</html>
